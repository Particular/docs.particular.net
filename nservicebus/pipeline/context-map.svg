<?xml version="1.0" encoding="utf-8"?>
<svg width="1755" height="1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="4" refY="3" orient="auto" markerUnits="strokeWidth" stroke-dasharray="none" stroke-width="1">
      <path d="M0,0 L0,6 L9,3 L0,0" fill="#000" />
    </marker>
  </defs>
  <rect x="40" y="240" width="190" height="120" style="fill:rgb(238,238,238);stroke-width:2;stroke:rgb(89,89,89);stroke-dasharray: 5,3" />
  <text x="135" y="300" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">
    <tspan x="135" dy="-0.45em">User</tspan>
    <tspan x="135" dy="1.2em">Code</tspan>
  </text>
  <rect x="310" y="80" width="190" height="120" style="fill:rgb(217,234,211);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="405" y="140" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">
    <tspan x="405" dy="-0.45em">Outgoing</tspan>
    <tspan x="405" dy="1.2em">Publish</tspan>
  </text>
  <rect x="310" y="240" width="190" height="120" style="fill:rgb(217,234,211);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="405" y="300" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">
    <tspan x="405" dy="-0.45em">Outgoing</tspan>
    <tspan x="405" dy="1.2em">Send</tspan>
  </text>
  <rect x="310" y="400" width="190" height="120" style="fill:rgb(217,234,211);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="405" y="460" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">
    <tspan x="405" dy="-0.45em">Outgoing</tspan>
    <tspan x="405" dy="1.2em">Reply</tspan>
  </text>
  <rect x="580" y="240" width="190" height="120" style="fill:rgb(217,234,211);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="675" y="300" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">
    <tspan x="675" dy="-0.90em">Outgoing</tspan>
    <tspan x="675" dy="1.2em">Logical</tspan>
    <tspan x="675" dy="1.2em">Message</tspan>
  </text>
  <rect x="850" y="240" width="190" height="120" style="fill:rgb(217,234,211);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="945" y="300" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">
    <tspan x="945" dy="-0.90em">Outgoing</tspan>
    <tspan x="945" dy="1.2em">Physical</tspan>
    <tspan x="945" dy="1.2em">Message</tspan>
  </text>
  <rect x="850" y="440" width="190" height="120" style="fill:rgb(217,234,211);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="945" y="500" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">Routing</text>
  <rect x="1255" y="440" width="190" height="120" style="fill:rgb(238,238,238);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="1350" y="500" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">Dispatch</text>
  <rect x="310" y="840" width="190" height="120" style="fill:rgb(164,194,244);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="405" y="900" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">
    <tspan x="405" dy="-0.45em">Invoke</tspan>
    <tspan x="405" dy="1.2em">Handler</tspan>
  </text>
  <rect x="580" y="840" width="190" height="120" style="fill:rgb(164,194,244);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="675" y="900" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">
    <tspan x="675" dy="-0.90em">Incoming</tspan>
    <tspan x="675" dy="1.2em">Logical</tspan>
    <tspan x="675" dy="1.2em">Message</tspan>
  </text>
  <rect x="850" y="840" width="190" height="120" style="fill:rgb(164,194,244);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="945" y="900" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">
    <tspan x="945" dy="-0.90em">Incoming</tspan>
    <tspan x="945" dy="1.2em">Physical</tspan>
    <tspan x="945" dy="1.2em">Message</tspan>
  </text>
  <rect x="1255" y="840" width="190" height="120" style="fill:rgb(238,238,238);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="1350" y="900" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">
    <tspan x="1350" dy="-0.45em">Transport</tspan>
    <tspan x="1350" dy="1.2em">Receive</tspan>
  </text>
  <rect x="1525" y="640" width="190" height="120" style="fill:rgb(238,238,238);stroke-width:2;stroke:rgb(89,89,89);stroke-dasharray: 5,3" />
  <text x="1620" y="700" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">Transport</text>
  <rect x="1255" y="640" width="190" height="120" style="fill:rgb(238,238,238);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="1350" y="700" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">
    <tspan x="1350" dy="-0.45em">Batch</tspan>
    <tspan x="1350" dy="1.2em">Dispatch</tspan>
  </text>
  <rect x="985" y="640" width="190" height="120" style="fill:rgb(238,238,238);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="1080" y="700" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">Audit</text>
  <rect x="715" y="640" width="190" height="120" style="fill:rgb(238,238,238);stroke-width:2;stroke:rgb(0,0,0)" />
  <text x="810" y="700" text-anchor="middle" alignment-baseline="middle" font-size="20pt" font-family="Arial">Forwarding</text>
  <path d="M 230 300 h 35 v 0 h 35" style="stroke: black;stroke-width:2;stroke-dasharray:5,2,2" marker-end="url(#arrow)" fill="none" />
  <path d="M 230 300 h 35 v -160 h 35" style="stroke: black;stroke-width:2;stroke-dasharray:5,2,2" marker-end="url(#arrow)" fill="none" />
  <path d="M 230 300 h 35 v 160 h 35" style="stroke: black;stroke-width:2;stroke-dasharray:5,2,2" marker-end="url(#arrow)" fill="none" />
  <path d="M 500 300 h 35 v 0 h 35" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 500 140 h 35 v 160 h 35" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 500 460 h 35 v -160 h 35" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 770 300 h 35 v 0 h 35" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 945 360 v 35 h 0 v 35" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 1040 500 h 102 v 0 h 102" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 1445 500 h 175 v 130" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 1620 760 v 140 h -165" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 1255 900 h -102 v 0 h -102" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 850 900 h -35 v 0 h -35" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 580 900 h -35 v 0 h -35" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 310 900 h -175 v -530" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 1350 840 v -35 h 0 v -35" style="stroke: black;stroke-width:2;stroke-dasharray: 5,2" marker-end="url(#arrow)" fill="none" />
  <path d="M 1350 640 v -35 h 0 v -35" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 945 840 v -35 h 135 v -35" style="stroke: black;stroke-width:2;stroke-dasharray: 5,2" marker-end="url(#arrow)" fill="none" />
  <path d="M 1080 640 v -35 h -135 v -35" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
  <path d="M 945 840 v -35 h -135 v -35" style="stroke: black;stroke-width:2;stroke-dasharray: 5,2" marker-end="url(#arrow)" fill="none" />
  <path d="M 810 640 v -35 h 135 v -35" style="stroke: black;stroke-width:2" marker-end="url(#arrow)" fill="none" />
</svg>